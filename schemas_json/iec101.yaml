---
"$schema": "http://json-schema.org/schema#"
id: "hat-gateway://iec101.yaml#"
definitions:
    master:
        type: object
        required:
            - port
            - baudrate
            - bytesize
            - parity
            - stopbits
            - flow_control
            - silent_interval
            - device_address_size
            - cause_size
            - asdu_address_size
            - io_address_size
            - reconnect_delay
            - remote_devices
        properties:
            port:
                type: string
            baudrate:
                type: integer
            bytesize:
                enum:
                    - FIVEBITS
                    - SIXBITS
                    - SEVENBITS
                    - EIGHTBITS
            parity:
                enum:
                    - NONE
                    - EVEN
                    - ODD
                    - MARK
                    - SPACE
            stopbits:
                enum:
                    - ONE
                    - ONE_POINT_FIVE
                    - TWO
            flow_control:
                type: object
                required:
                    - xonxoff
                    - rtscts
                    - dsrdtr
                properties:
                    xonxoff:
                        type: boolean
                    rtscts:
                        type: boolean
                    dsrdtr:
                        type: boolean
            silent_interval:
                type: number
            device_address_size:
                enum:
                    - ONE
                    - TWO
            cause_size:
                enum:
                    - ONE
                    - TWO
            asdu_address_size:
                enum:
                    - ONE
                    - TWO
            io_address_size:
                enum:
                    - ONE
                    - TWO
                    - THREE
            reconnect_delay:
                type: number
            remote_devices:
                type: array
                items:
                    type: object
                    required:
                        - address
                        - response_timeout
                        - send_retry_count
                        - poll_class1_delay
                        - poll_class2_delay
                        - reconnect_delay
                        - time_sync_delay
                    properties:
                        address:
                            type: integer
                        response_timeout:
                            type: number
                        send_retry_count:
                            type: number
                        poll_class1_delay:
                            type:
                                - "null"
                                - number
                        poll_class2_delay:
                            type:
                                - "null"
                                - number
                        reconnect_delay:
                            type: number
                        time_sync_delay:
                            type:
                                - "null"
                                - number
    events:
        master:
            gateway:
                status:
                    enum:
                        - CONNECTING
                        - CONNECTED
                        - DISCONNECTED
                data:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/messages/data/res"
                command:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/messages/command/res"
                interrogation:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/messages/interrogation/res"
                counter_interrogation:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/messages/counter_interrogation/res"
            system:
                enable:
                    type: boolean
                command:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/messages/command/req"
                interrogation:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/messages/interrogation/req"
                counter_interrogation:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/messages/counter_interrogation/req"
    messages:
        data:
            res:
                type: object
                required:
                    - cause
                properties:
                    cause:
                        enum:
                            - PERIODIC
                            - BACKGROUND_SCAN
                            - SPONTANEOUS
                            - REQUEST
                            - REMOTE_COMMAND
                            - LOCAL_COMMAND
                            - INTERROGATED
                oneOf:
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/single"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/double"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/step_position"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/bitstring"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/normalized"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/scaled"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/floating"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/binary_counter"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/protection"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/protection_start"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/protection_command"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/data_types/status"
        command:
            req:
                type: object
                required:
                    - cause
                properties:
                    cause:
                        enum:
                            - ACTIVATION
                            - DEACTIVATION
                oneOf:
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/single"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/double"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/regulating"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/normalized"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/scaled"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/floating"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/bitstring"
            res:
                type: object
                required:
                    - cause
                    - success
                properties:
                    cause:
                        enum:
                            - ACTIVATION_CONFIRMATION
                            - DEACTIVATION_CONFIRMATION
                            - ACTIVATION_TERMINATION
                            - UNKNOWN_TYPE
                            - UNKNOWN_CAUSE
                            - UNKNOWN_ASDU_ADDRESS
                            - UNKNOWN_IO_ADDRESS
                    success:
                        type: boolean
                oneOf:
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/single"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/double"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/regulating"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/normalized"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/scaled"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/floating"
                    - "$ref": "hat-gateway://iec101.yaml#/definitions/command_types/bitstring"
        interrogation:
            req:
                type: object
                required:
                    - request
                properties:
                    request:
                        type: integer
            res:
                type: object
                required:
                    - request
                properties:
                    request:
                        type: integer
        counter_interrogation:
            req:
                type: object
                required:
                    - request
                    - freeze
                properties:
                    request:
                        type: integer
                    freeze:
                        enum:
                            - READ
                            - FREEZE
                            - FREEZE_AND_RESET
                            - RESET
            res:
                type: object
                required:
                    - request
                    - freeze
                properties:
                    request:
                        type: integer
                    freeze:
                        enum:
                            - READ
                            - FREEZE
                            - FREEZE_AND_RESET
                            - RESET
    data_types:
        single:
            type: object
            required:
                - value
                - quality
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/single"
                quality:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/indication"
        double:
            type: object
            required:
                - value
                - quality
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/double"
                quality:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/indication"
        step_position:
            type: object
            required:
                - value
                - quality
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/step_position"
                quality:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/measurement"
        bitstring:
            type: object
            required:
                - value
                - quality
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/bitstring"
                quality:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/measurement"
        normalized:
            type: object
            required:
                - value
                - quality
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/normalized"
                quality:
                    oneOf:
                      - type: "null"
                      - "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/measurement"
        scaled:
            type: object
            required:
                - value
                - quality
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/scaled"
                quality:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/measurement"
        floating:
            type: object
            required:
                - value
                - quality
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/floating"
                quality:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/measurement"
        binary_counter:
            type: object
            required:
                - value
                - quality
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/binary_counter"
                quality:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/counter"
        protection:
            type: object
            required:
                - value
                - quality
                - elapsed_time
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/protection"
                quality:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/protection"
                elapsed_time:
                    type: integer
        protection_start:
            type: object
            required:
                - value
                - quality
                - duration_time
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/protection_start"
                quality:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/protection"
                duration_time:
                    type: integer
        protection_command:
            type: object
            required:
                - value
                - quality
                - operating_time
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/protection_command"
                quality:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/protection"
                operating_time:
                    type: integer
        status:
            type: object
            required:
                - value
                - quality
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/status"
                quality:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/qualities/measurement"
    command_types:
        single:
            type: object
            required:
                - value
                - select
                - qualifier
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/single"
                select:
                    type: boolean
                qualifier:
                    type: integer
        double:
            type: object
            required:
                - value
                - select
                - qualifier
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/double"
                select:
                    type: boolean
                qualifier:
                    type: integer
        regulating:
            type: object
            required:
                - value
                - select
                - qualifier
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/regulating"
                select:
                    type: boolean
                qualifier:
                    type: integer
        normalized:
            type: object
            required:
                - value
                - select
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/normalized"
                select:
                    type: boolean
        scaled:
            type: object
            required:
                - value
                - select
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/scaled"
                select:
                    type: boolean
        floating:
            type: object
            required:
                - value
                - select
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/floating"
                select:
                    type: boolean
        bitstring:
            type: object
            required:
                - value
            properties:
                value:
                    "$ref": "hat-gateway://iec101.yaml#/definitions/values/bitstring"
    values:
        single:
            enum:
                - "OFF"
                - "ON"
        double:
            enum:
                - "INTERMEDIATE"
                - "OFF"
                - "ON"
                - "FAULT"
        regulating:
            enum:
                - LOWER
                - HIGHER
        step_position:
            type: object
            required:
                - value
                - transient
            properties:
                value:
                    type: integer
                transient:
                    type: boolean
        bitstring:
            type: array
            items:
                type: integer
        normalized:
            type: number
        scaled:
            type: integer
        floating:
            type: number
        binary_counter:
            type: integer
        protection:
            enum:
                - "OFF"
                - "ON"
        protection_start:
            type: object
            required:
                - general
                - l1
                - l2
                - l3
                - ie
                - reverse
            properties:
                general:
                    type: boolean
                l1:
                    type: boolean
                l2:
                    type: boolean
                l3:
                    type: boolean
                ie:
                    type: boolean
                reverse:
                    type: boolean
        protection_command:
            type: object
            required:
                - general
                - l1
                - l2
                - l3
            properties:
                general:
                    type: boolean
                l1:
                    type: boolean
                l2:
                    type: boolean
                l3:
                    type: boolean
        status:
            type: object
            required:
                - value
                - change
            properties:
                value:
                    type: array
                    items:
                        type: boolean
                change:
                    type: array
                    items:
                        type: boolean
    qualities:
        indication:
            type: object
            required:
                - invalid
                - not_topical
                - substituted
                - blocked
            properties:
                invalid:
                    type: boolean
                not_topical:
                    type: boolean
                substituted:
                    type: boolean
                blocked:
                    type: boolean
        measurement:
            type: object
            required:
                - invalid
                - not_topical
                - substituted
                - blocked
                - overflow
            properties:
                invalid:
                    type: boolean
                not_topical:
                    type: boolean
                substituted:
                    type: boolean
                blocked:
                    type: boolean
                overflow:
                    type: boolean
        counter:
            type: object
            required:
                - invalid
                - adjusted
                - overflow
                - sequence
            properties:
                invalid:
                    type: boolean
                adjusted:
                    type: boolean
                overflow:
                    type: boolean
                sequence:
                    type: boolean
        protection:
            type: object
            required:
                - invalid
                - not_topical
                - substituted
                - blocked
                - time_invalid
            properties:
                invalid:
                    type: boolean
                not_topical:
                    type: boolean
                substituted:
                    type: boolean
                blocked:
                    type: boolean
                time_invalid:
                    type: boolean
...
